services:
  # نام سرویس
  medical_agent_api:
    # ساخت ایمیج از Dockerfile در پوشه فعلی
    build:
      context: .
      dockerfile: Dockerfile
    
    # مپ کردن پورت 8080 سیستم میزبان به پورت 8000 داخل کانتینر
    # توجه: پورت سیستم میزبان از 80 به 8080 تغییر داده شد.
    ports:
      - "8080:8000"
      
    # تعریف صریح دستور اجرا برای اطمینان از بارگذاری 'app:app'
    command: ["uvicorn", "app:app", "--host", "0.0.0.0", "--port", "8000"]
    
    # اگر کانتینر دچار مشکل شد، سعی می‌کند آن را مجدداً راه‌اندازی کند
    restart: always